# Activity-Recognition
This contains the code for the explanation layer of the paper on [explainable activity recognition of videos](https://www.cise.ufl.edu/~eragan/papers/Roy_2019_IUI.pdf).

It learns a [dynamic cutset network](https://personal.utdallas.edu/~chiradeep.roy/media/dcn.pdf) by using a [conditional cutset network](https://personal.utdallas.edu/~txr110830/papers/ijcai19.pdf) to model the transitions between sequences. It then uses particle filtering to compile each video into a set of ranked explanations and marginal probabilities for each frame.

*Note: Before using the explanation module, we first need to generate a set of noisy labels using a CNN individually for each frame. We recommend using Radek Bartyzal's implementation of the [Multi-Label Inception Network](https://github.com/BartyzalRadek/Multi-label-Inception-net).*

### Inputs
1. **dset.train.ground:** set of ground/true labels for each sampled frame in the *training* set (CSV)
2. **dset.train.evid:** set of noisy labels generated by a neural network for each sampled frame in the *training* set (CSV)
3. **dset.train.seq:** sequence lengths of each sequence in the *training* set (CSV)
4. **dset.test.ground:** set of ground/true labels for each sampled frame in the *test* set (CSV)
5. **dset.test.evid:** set of noisy labels generated by a neural network for each sampled frame in the *test* set (CSV)
6. **dset.test.seq:** sequence lengths of each sequence in the *test* set (CSV)

### Usage
`python main.py <data-dir> <dset-name> <prior-depth> <trans-depth> <function> <alpha> [ <K> <L> <output-dir> ]`

##### Arguments:
- **\<data-dir\>:**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Path to directory that contains the datasets
- **\<dset-name\>:**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Name of the dataset
- **\<prior-depth\>:**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Maximum depth of prior cutset network
- **\<trans-depth\>:**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Maximum depth of transition conditional cutset network (CCN)
- **\<function\>:**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Function to be used for CCN (LR or NN)
- **\<alpha\>:**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hyperparameter for neural network
- **\<K\>:**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Number of samples to use for particle filtering [ default: 10 ]
- **\<L\>:**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Number of ranked explanations [ default: 3 ]
- **\<output-dir\>:**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Path to directory that contains the datasets [ default: data directory ]

##### Example:
`python main.py data tacos 5 5 LR 0.01 10 3`

### References
1. **Explainable Activity Recognition in Videos** -- *Roy C., Shanbhag S., Rahman T., Gogate V., Ruozzi N., Nourani M., Ragen E.D., and Kabir S.,* ACM IUI Workshops, 2019
2. **Cutset Networks: A Simple, Tractable, and Scalable Approach for Improving the Accuracy of Chow-Liu Trees** -- *Rahman T., Kothalkar P., and Gogate V.*, ECML/PKDD, 2014
3. **Cutset Bayesian Networks: A New Representation for Learning Rao-Blackwellised Graphical Models** -- *Rahman T., Jin S., and Gogate V.*, IJCAI, 2019
4. **Dynamic Cutset Networks** -- *Roy C., Rahman T., Dong H., Ruozzi N., and Gogate V.*, AISTATS, 2021
